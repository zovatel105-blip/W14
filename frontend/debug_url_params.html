<!DOCTYPE html>
<html>
<head>
    <title>Debug URL Parameters</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .success { background-color: #e8f5e9; }
        .error { background-color: #ffebee; }
    </style>
</head>
<body>
    <h1>Debug URL Parameters Test</h1>
    
    <div id="results"></div>
    
    <h2>Test Links</h2>
    <p><a href="#" onclick="testNavigation('demo')">Test with user=demo</a></p>
    <p><a href="#" onclick="testNavigation('testuser')">Test with user=testuser</a></p>
    <p><a href="#" onclick="testNavigation('vrx')">Test with user=vrx</a></p>
    
    <script>
        function addResult(message, isSuccess = true) {
            const div = document.createElement('div');
            div.className = `test ${isSuccess ? 'success' : 'error'}`;
            div.innerHTML = message;
            document.getElementById('results').appendChild(div);
        }
        
        function testNavigation(username) {
            // Simulate the navigation that ProfilePage does
            const testUrl = `/messages?user=${username}`;
            
            // Test URL parsing (what MessagesMainPage should do)
            const url = new URL(window.location.origin + testUrl);
            const urlParams = new URLSearchParams(url.search);
            const extractedUser = urlParams.get('user');
            
            addResult(`
                <strong>Navigation Test for ${username}:</strong><br>
                Generated URL: ${testUrl}<br>
                Extracted user parameter: ${extractedUser}<br>
                Test: ${extractedUser === username ? 'PASS ✅' : 'FAIL ❌'}
            `, extractedUser === username);
            
            // Simulate what should happen next
            if (extractedUser === username) {
                addResult(`
                    <strong>MessagesMainPage Logic Simulation:</strong><br>
                    1. URL parameter detected: ${extractedUser}<br>
                    2. Should search for conversation with user: ${extractedUser}<br>
                    3. Should open chat directly<br>
                    4. Should clean URL to /messages
                `);
            }
        }
        
        // Test current URL if it has parameters
        window.onload = function() {
            const currentParams = new URLSearchParams(window.location.search);
            const currentUser = currentParams.get('user');
            
            if (currentUser) {
                addResult(`
                    <strong>Current URL Analysis:</strong><br>
                    Full URL: ${window.location.href}<br>
                    User parameter: ${currentUser}<br>
                    This URL should trigger direct chat opening in MessagesMainPage
                `);
            } else {
                addResult(`
                    <strong>Current URL Analysis:</strong><br>
                    No user parameter in current URL: ${window.location.href}
                `);
            }
        };
    </script>
</body>
</html>